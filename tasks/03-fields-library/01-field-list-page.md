# Task: Field List Page

**Priority:** üü° Medium
**Estimated Time:** 1.5 g√ºn
**Dependencies:** 02-api-integration, 09-ui-components (Table)

---

## Objective

Field'larƒ± (form alanlarƒ±) listelemek, arama yapmak, filtrelemek ve y√∂netmek i√ßin TanStack Table tabanlƒ± bir sayfa olu≈üturmak.

---

## Backend API

### Endpoint
```
GET /api/fields
```

### Query Parameters
| Parametre | Tip | Zorunlu | A√ßƒ±klama |
|-----------|-----|---------|----------|
| category | string | Hayƒ±r | Kategori ile filtrele (√∂rn: "Contact Info", "Business", "System") |
| is_system | boolean | Hayƒ±r | Sistem field'larƒ±nƒ± filtrele (true = sadece sistem, false = sadece custom) |

### √ñrnek Request
```bash
# T√ºm field'larƒ± listele
GET /api/fields

# Sadece Contact Info kategorisi
GET /api/fields?category=Contact Info

# Sadece sistem field'larƒ±
GET /api/fields?is_system=true

# Sadece custom field'lar
GET /api/fields?is_system=false
```

### Response
```json
[
  {
    "id": "fld_created_at",
    "name": "created_at",
    "label": "Created At",
    "type": "datetime",
    "description": "Record creation timestamp",
    "category": "System",
    "is_global": true,
    "is_system_field": true,
    "is_custom": false,
    "config": {
      "readonly": true,
      "autoGenerated": true
    },
    "created_by": null,
    "created_at": "2026-01-01T00:00:00Z",
    "updated_at": "2026-01-01T00:00:00Z"
  },
  {
    "id": "fld_a1b2c3d4",
    "name": "email",
    "label": "Email Address",
    "type": "email",
    "description": "Contact email address",
    "category": "Contact Info",
    "is_global": false,
    "is_system_field": false,
    "is_custom": true,
    "config": {
      "validation": {
        "required": true,
        "regex": "^[^@]+@[^@]+\\.[^@]+$"
      },
      "placeholder": "user@example.com"
    },
    "created_by": "550e8400-e29b-41d4-a716-446655440000",
    "created_at": "2026-01-18T10:00:00Z",
    "updated_at": "2026-01-18T10:00:00Z"
  }
]
```

**Response Fields:**
- `id` - Field ID (fld_xxxxxxxx)
- `name` - Field adƒ± (snake_case, unique)
- `label` - G√∂r√ºnen ad
- `type` - Field tipi (12 farklƒ± tip)
- `description` - Field a√ßƒ±klamasƒ± (nullable)
- `category` - Kategori (nullable)
- `is_global` - Global field mi?
- `is_system_field` - Sistem field'ƒ± mƒ±? (silinemez)
- `is_custom` - Custom field mi?
- `config` - Field konfig√ºrasyonu (type'a g√∂re deƒüi≈üir)
- `created_by` - Olu≈üturan kullanƒ±cƒ± UUID (sistem field'larƒ±nda null)
- `created_at` - Olu≈üturulma zamanƒ±
- `updated_at` - Son g√ºncelleme zamanƒ±

### Field Types (12 Types)
```typescript
type FieldType =
  | "text"        // Single line text
  | "email"       // Email address
  | "phone"       // Phone number
  | "number"      // Number (integer/decimal)
  | "date"        // Date picker
  | "datetime"    // Date + Time picker
  | "textarea"    // Multi-line text
  | "select"      // Dropdown (single select)
  | "multiselect" // Multi-select dropdown
  | "checkbox"    // Boolean checkbox
  | "radio"       // Radio buttons
  | "url"         // URL
```

### Error Responses
- `401 Unauthorized` - JWT token eksik veya ge√ßersiz

**Backend Documentation:**
‚Üí [GET /api/fields](../../backend-docs/api/02-fields/02-list-fields.md)

---

## UI/UX Design

### Page Layout
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Fields Library                              [+ Create Field]    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üîç Search by name or label...                                   ‚îÇ
‚îÇ  [Category: All ‚ñº]  [Type: All ‚ñº]  [‚òê System Fields Only]      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Name          ‚îÇ Label            ‚îÇ Type      ‚îÇ Category ‚îÇ Actions‚îÇ
‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
‚îÇ  created_at    ‚îÇ Created At       ‚îÇ datetime  ‚îÇ System   ‚îÇ [View] ‚îÇ
‚îÇ  email         ‚îÇ Email Address    ‚îÇ email     ‚îÇ Contact  ‚îÇ [Edit] ‚îÇ
‚îÇ  phone         ‚îÇ Phone Number     ‚îÇ phone     ‚îÇ Contact  ‚îÇ [Edit] ‚îÇ
‚îÇ  company       ‚îÇ Company Name     ‚îÇ text      ‚îÇ Business ‚îÇ [Edit] ‚îÇ
‚îÇ  job_title     ‚îÇ Job Title        ‚îÇ text      ‚îÇ Business ‚îÇ [Edit] ‚îÇ
‚îÇ  ...           ‚îÇ ...              ‚îÇ ...       ‚îÇ ...      ‚îÇ ...    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Showing 1-50 of 150 fields               [‚Üê Prev] [1] [2] [Next]‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Features
1. **Search Bar**
   - Real-time search by name or label
   - Debounced input (300ms)
   - Clear button when text exists

2. **Category Filter**
   - Dropdown with all available categories
   - "All Categories" option (default)
   - Dynamic categories from backend data

3. **Type Filter**
   - Dropdown with all 12 field types
   - "All Types" option (default)
   - Shows type with icon

4. **System Fields Checkbox**
   - Toggle to show only system fields
   - Default: unchecked (shows all fields)

5. **Table Columns**
   - **Name** - Field name (snake_case)
   - **Label** - Display label
   - **Type** - Field type with icon
   - **Category** - Category badge
   - **Actions** - Edit/Delete buttons (Delete disabled for system fields)

6. **Pagination**
   - 50 items per page
   - Client-side pagination
   - Shows total count

7. **Actions Column**
   - **View** button (system fields only)
   - **Edit** button (custom fields)
   - **Delete** button (custom fields only, shows confirmation)

### States
- **Loading** - Skeleton loader
- **Empty** - No fields found (show create button)
- **Error** - Error message with retry
- **Success** - Table with data

---

## Technical Details

### File Structure
```
src/
‚îú‚îÄ‚îÄ features/
‚îÇ   ‚îî‚îÄ‚îÄ fields/
‚îÇ       ‚îú‚îÄ‚îÄ pages/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ FieldsListPage.tsx          ‚≠ê Main page component
‚îÇ       ‚îú‚îÄ‚îÄ components/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ FieldsTable.tsx             ‚≠ê TanStack Table component
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ FieldsTableSkeleton.tsx     ‚≠ê Loading skeleton
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ FieldsTableEmpty.tsx        ‚≠ê Empty state
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ FieldTypeIcon.tsx           ‚≠ê Field type icon component
‚îÇ       ‚îú‚îÄ‚îÄ hooks/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ useFields.ts                ‚≠ê Fetch fields hook
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ useFieldsTable.ts           ‚≠ê Table logic hook
‚îÇ       ‚îî‚îÄ‚îÄ types/
‚îÇ           ‚îî‚îÄ‚îÄ field.types.ts              ‚≠ê TypeScript types
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ       ‚îî‚îÄ‚îÄ fields.api.ts                   ‚≠ê API calls
‚îî‚îÄ‚îÄ components/
    ‚îî‚îÄ‚îÄ ui/
        ‚îî‚îÄ‚îÄ Table.tsx                       ‚≠ê Reusable Table component (TanStack Table)
```

### Component Implementation

#### FieldsListPage.tsx
```typescript
import { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { Button } from '@/components/ui/Button';
import { FieldsTable } from '../components/FieldsTable';
import { useFields } from '../hooks/useFields';
import { FieldsTableSkeleton } from '../components/FieldsTableSkeleton';
import { FieldsTableEmpty } from '../components/FieldsTableEmpty';
import { Plus } from 'lucide-react';

export const FieldsListPage = () => {
  const navigate = useNavigate();
  const [search, setSearch] = useState('');
  const [categoryFilter, setCategoryFilter] = useState<string | null>(null);
  const [typeFilter, setTypeFilter] = useState<string | null>(null);
  const [systemOnlyFilter, setSystemOnlyFilter] = useState(false);

  const { data: fields, isLoading, isError, error } = useFields({
    category: categoryFilter,
    is_system: systemOnlyFilter || undefined,
  });

  // Client-side filtering for search and type
  const filteredFields = fields?.filter((field) => {
    const matchesSearch =
      !search ||
      field.name.toLowerCase().includes(search.toLowerCase()) ||
      field.label.toLowerCase().includes(search.toLowerCase());

    const matchesType = !typeFilter || field.type === typeFilter;

    return matchesSearch && matchesType;
  }) ?? [];

  if (isLoading) {
    return (
      <div className="p-6">
        <div className="flex justify-between items-center mb-6">
          <h1 className="text-3xl font-bold">Fields Library</h1>
          <Button disabled>
            <Plus className="w-4 h-4 mr-2" />
            Create Field
          </Button>
        </div>
        <FieldsTableSkeleton />
      </div>
    );
  }

  if (isError) {
    return (
      <div className="p-6">
        <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded">
          {error?.message || 'Failed to load fields'}
        </div>
      </div>
    );
  }

  return (
    <div className="p-6">
      {/* Header */}
      <div className="flex justify-between items-center mb-6">
        <h1 className="text-3xl font-bold">Fields Library</h1>
        <Button onClick={() => navigate('/fields/create')}>
          <Plus className="w-4 h-4 mr-2" />
          Create Field
        </Button>
      </div>

      {/* Filters */}
      <div className="mb-6 space-y-4">
        {/* Search */}
        <div>
          <input
            type="text"
            placeholder="üîç Search by name or label..."
            value={search}
            onChange={(e) => setSearch(e.target.value)}
            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          />
        </div>

        {/* Dropdowns and Checkbox */}
        <div className="flex gap-4">
          <select
            value={categoryFilter ?? ''}
            onChange={(e) => setCategoryFilter(e.target.value || null)}
            className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
          >
            <option value="">All Categories</option>
            <option value="System">System</option>
            <option value="Contact Info">Contact Info</option>
            <option value="Business">Business</option>
            <option value="Address">Address</option>
          </select>

          <select
            value={typeFilter ?? ''}
            onChange={(e) => setTypeFilter(e.target.value || null)}
            className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
          >
            <option value="">All Types</option>
            <option value="text">Text</option>
            <option value="email">Email</option>
            <option value="phone">Phone</option>
            <option value="number">Number</option>
            <option value="date">Date</option>
            <option value="datetime">DateTime</option>
            <option value="textarea">Textarea</option>
            <option value="select">Select</option>
            <option value="multiselect">Multi-Select</option>
            <option value="checkbox">Checkbox</option>
            <option value="radio">Radio</option>
            <option value="url">URL</option>
          </select>

          <label className="flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg">
            <input
              type="checkbox"
              checked={systemOnlyFilter}
              onChange={(e) => setSystemOnlyFilter(e.target.checked)}
              className="rounded border-gray-300 text-blue-600 focus:ring-blue-500"
            />
            <span className="text-sm">System Fields Only</span>
          </label>
        </div>
      </div>

      {/* Table */}
      {filteredFields.length === 0 ? (
        <FieldsTableEmpty onCreateClick={() => navigate('/fields/create')} />
      ) : (
        <FieldsTable fields={filteredFields} />
      )}
    </div>
  );
};
```

#### FieldsTable.tsx
```typescript
import { useMemo } from 'react';
import {
  useReactTable,
  getCoreRowModel,
  getPaginationRowModel,
  getSortedRowModel,
  ColumnDef,
  flexRender,
} from '@tanstack/react-table';
import { Field } from '../types/field.types';
import { FieldTypeIcon } from './FieldTypeIcon';
import { Button } from '@/components/ui/Button';
import { Pencil, Trash2, Eye } from 'lucide-react';
import { useNavigate } from 'react-router-dom';

interface FieldsTableProps {
  fields: Field[];
}

export const FieldsTable = ({ fields }: FieldsTableProps) => {
  const navigate = useNavigate();

  const columns = useMemo<ColumnDef<Field>[]>(
    () => [
      {
        accessorKey: 'name',
        header: 'Name',
        cell: (info) => (
          <span className="font-mono text-sm">{info.getValue() as string}</span>
        ),
      },
      {
        accessorKey: 'label',
        header: 'Label',
        cell: (info) => (
          <span className="font-medium">{info.getValue() as string}</span>
        ),
      },
      {
        accessorKey: 'type',
        header: 'Type',
        cell: (info) => {
          const type = info.getValue() as string;
          return (
            <div className="flex items-center gap-2">
              <FieldTypeIcon type={type} />
              <span className="text-sm capitalize">{type}</span>
            </div>
          );
        },
      },
      {
        accessorKey: 'category',
        header: 'Category',
        cell: (info) => {
          const category = info.getValue() as string | null;
          if (!category) return <span className="text-gray-400">‚Äî</span>;
          return (
            <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
              {category}
            </span>
          );
        },
      },
      {
        id: 'actions',
        header: 'Actions',
        cell: (info) => {
          const field = info.row.original;
          const isSystem = field.is_system_field;

          return (
            <div className="flex gap-2">
              {isSystem ? (
                <Button
                  size="sm"
                  variant="ghost"
                  onClick={() => navigate(`/fields/${field.id}`)}
                >
                  <Eye className="w-4 h-4" />
                </Button>
              ) : (
                <>
                  <Button
                    size="sm"
                    variant="ghost"
                    onClick={() => navigate(`/fields/${field.id}/edit`)}
                  >
                    <Pencil className="w-4 h-4" />
                  </Button>
                  <Button
                    size="sm"
                    variant="ghost"
                    onClick={() => {
                      if (confirm(`Delete field "${field.label}"?`)) {
                        // TODO: Implement delete mutation
                      }
                    }}
                  >
                    <Trash2 className="w-4 h-4 text-red-600" />
                  </Button>
                </>
              )}
            </div>
          );
        },
      },
    ],
    [navigate]
  );

  const table = useReactTable({
    data: fields,
    columns,
    getCoreRowModel: getCoreRowModel(),
    getPaginationRowModel: getPaginationRowModel(),
    getSortedRowModel: getSortedRowModel(),
    initialState: {
      pagination: {
        pageSize: 50,
      },
    },
  });

  return (
    <div>
      {/* Table */}
      <div className="overflow-hidden border border-gray-200 rounded-lg">
        <table className="min-w-full divide-y divide-gray-200">
          <thead className="bg-gray-50">
            {table.getHeaderGroups().map((headerGroup) => (
              <tr key={headerGroup.id}>
                {headerGroup.headers.map((header) => (
                  <th
                    key={header.id}
                    className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    {flexRender(
                      header.column.columnDef.header,
                      header.getContext()
                    )}
                  </th>
                ))}
              </tr>
            ))}
          </thead>
          <tbody className="bg-white divide-y divide-gray-200">
            {table.getRowModel().rows.map((row) => (
              <tr key={row.id} className="hover:bg-gray-50">
                {row.getVisibleCells().map((cell) => (
                  <td key={cell.id} className="px-6 py-4 whitespace-nowrap">
                    {flexRender(cell.column.columnDef.cell, cell.getContext())}
                  </td>
                ))}
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      {/* Pagination */}
      <div className="flex items-center justify-between px-6 py-4 border-t border-gray-200">
        <div className="text-sm text-gray-700">
          Showing {table.getState().pagination.pageIndex * 50 + 1} to{' '}
          {Math.min(
            (table.getState().pagination.pageIndex + 1) * 50,
            fields.length
          )}{' '}
          of {fields.length} fields
        </div>
        <div className="flex gap-2">
          <Button
            size="sm"
            variant="outline"
            onClick={() => table.previousPage()}
            disabled={!table.getCanPreviousPage()}
          >
            ‚Üê Prev
          </Button>
          <Button
            size="sm"
            variant="outline"
            onClick={() => table.nextPage()}
            disabled={!table.getCanNextPage()}
          >
            Next ‚Üí
          </Button>
        </div>
      </div>
    </div>
  );
};
```

#### useFields.ts
```typescript
import { useQuery } from '@tanstack/react-query';
import { getFieldsAPI } from '@/lib/api/fields.api';

interface UseFieldsParams {
  category?: string | null;
  is_system?: boolean;
}

export const useFields = (params?: UseFieldsParams) => {
  return useQuery({
    queryKey: ['fields', params],
    queryFn: () => getFieldsAPI(params),
    staleTime: 1000 * 60 * 5, // 5 minutes
  });
};
```

#### fields.api.ts
```typescript
import { apiClient } from './client';
import { Field } from '@/features/fields/types/field.types';

interface GetFieldsParams {
  category?: string | null;
  is_system?: boolean;
}

export const getFieldsAPI = async (params?: GetFieldsParams): Promise<Field[]> => {
  const queryParams = new URLSearchParams();

  if (params?.category) {
    queryParams.append('category', params.category);
  }

  if (params?.is_system !== undefined) {
    queryParams.append('is_system', String(params.is_system));
  }

  const queryString = queryParams.toString();
  const url = `/api/fields${queryString ? `?${queryString}` : ''}`;

  const { data } = await apiClient.get<Field[]>(url);
  return data;
};
```

#### field.types.ts
```typescript
export type FieldType =
  | 'text'
  | 'email'
  | 'phone'
  | 'number'
  | 'date'
  | 'datetime'
  | 'textarea'
  | 'select'
  | 'multiselect'
  | 'checkbox'
  | 'radio'
  | 'url';

export interface Field {
  id: string;
  name: string;
  label: string;
  type: FieldType;
  description: string | null;
  category: string | null;
  is_global: boolean;
  is_system_field: boolean;
  is_custom: boolean;
  config: Record<string, any>;
  created_by: string | null;
  created_at: string;
  updated_at: string;
}

export interface FieldFilters {
  category?: string | null;
  is_system?: boolean;
  search?: string;
  type?: FieldType | null;
}
```

#### FieldsTableSkeleton.tsx
```typescript
export const FieldsTableSkeleton = () => {
  return (
    <div className="animate-pulse">
      <div className="mb-4 space-y-3">
        <div className="h-10 bg-gray-200 rounded"></div>
        <div className="flex gap-4">
          <div className="h-10 w-48 bg-gray-200 rounded"></div>
          <div className="h-10 w-48 bg-gray-200 rounded"></div>
          <div className="h-10 w-48 bg-gray-200 rounded"></div>
        </div>
      </div>
      <div className="border border-gray-200 rounded-lg">
        <div className="h-12 bg-gray-100 border-b border-gray-200"></div>
        {[...Array(10)].map((_, i) => (
          <div key={i} className="h-16 border-b border-gray-200 bg-white"></div>
        ))}
      </div>
    </div>
  );
};
```

#### FieldsTableEmpty.tsx
```typescript
import { Button } from '@/components/ui/Button';
import { Plus } from 'lucide-react';

interface FieldsTableEmptyProps {
  onCreateClick: () => void;
}

export const FieldsTableEmpty = ({ onCreateClick }: FieldsTableEmptyProps) => {
  return (
    <div className="text-center py-12 border border-gray-200 rounded-lg bg-gray-50">
      <div className="text-gray-400 mb-4">
        <svg
          className="mx-auto h-12 w-12"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            strokeWidth={2}
            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
          />
        </svg>
      </div>
      <h3 className="text-lg font-medium text-gray-900 mb-2">No fields found</h3>
      <p className="text-gray-500 mb-6">
        Get started by creating your first field.
      </p>
      <Button onClick={onCreateClick}>
        <Plus className="w-4 h-4 mr-2" />
        Create Field
      </Button>
    </div>
  );
};
```

#### FieldTypeIcon.tsx
```typescript
import {
  Type,
  Mail,
  Phone,
  Hash,
  Calendar,
  Clock,
  AlignLeft,
  ChevronDown,
  CheckSquare,
  Circle,
  Link2,
} from 'lucide-react';
import { FieldType } from '../types/field.types';

interface FieldTypeIconProps {
  type: FieldType;
}

export const FieldTypeIcon = ({ type }: FieldTypeIconProps) => {
  const iconClass = 'w-4 h-4 text-gray-600';

  switch (type) {
    case 'text':
      return <Type className={iconClass} />;
    case 'email':
      return <Mail className={iconClass} />;
    case 'phone':
      return <Phone className={iconClass} />;
    case 'number':
      return <Hash className={iconClass} />;
    case 'date':
      return <Calendar className={iconClass} />;
    case 'datetime':
      return <Clock className={iconClass} />;
    case 'textarea':
      return <AlignLeft className={iconClass} />;
    case 'select':
    case 'multiselect':
      return <ChevronDown className={iconClass} />;
    case 'checkbox':
      return <CheckSquare className={iconClass} />;
    case 'radio':
      return <Circle className={iconClass} />;
    case 'url':
      return <Link2 className={iconClass} />;
    default:
      return <Type className={iconClass} />;
  }
};
```

---

## Dependencies

### NPM Packages (Already Installed ‚úÖ)
- `@tanstack/react-table` - Table component
- `@tanstack/react-query` - API state management
- `react-router-dom` - Navigation
- `lucide-react` - Icons

### UI Components (To Be Built)
- `Button` component (React Aria)
- Table styling (Tailwind CSS)

---

## Acceptance Criteria

- [ ] Fields list page `/fields` route'unda √ßalƒ±≈üƒ±yor
- [ ] T√ºm field'lar tabloda listeleniyor
- [ ] Search by name/label √ßalƒ±≈üƒ±yor (client-side, debounced)
- [ ] Category filter dropdown √ßalƒ±≈üƒ±yor (backend filter)
- [ ] Type filter dropdown √ßalƒ±≈üƒ±yor (client-side filter)
- [ ] System fields only checkbox √ßalƒ±≈üƒ±yor (backend filter)
- [ ] Pagination √ßalƒ±≈üƒ±yor (50 per page, client-side)
- [ ] Actions column: Edit butonu √ßalƒ±≈üƒ±yor (custom fields)
- [ ] Actions column: Delete butonu √ßalƒ±≈üƒ±yor (custom fields)
- [ ] Actions column: View butonu √ßalƒ±≈üƒ±yor (system fields)
- [ ] System field'lar Delete butonu disabled
- [ ] Loading skeleton g√∂r√ºn√ºyor
- [ ] Empty state g√∂r√ºn√ºyor (no results)
- [ ] Error state g√∂r√ºn√ºyor (API error)
- [ ] Mobile responsive design
- [ ] Create Field butonu `/fields/create` sayfasƒ±na y√∂nlendiriyor

---

## Testing Checklist

### Manual Testing
- [ ] Sayfa y√ºklendiƒüinde t√ºm field'lar g√∂r√ºn√ºyor
- [ ] Search bar'a yazƒ±nca filtreleme √ßalƒ±≈üƒ±yor
- [ ] Category dropdown'dan se√ßim yapƒ±nca filtreleniyor
- [ ] Type dropdown'dan se√ßim yapƒ±nca filtreleniyor
- [ ] System Fields checkbox i≈üaretlenince sadece sistem field'larƒ± g√∂r√ºn√ºyor
- [ ] Pagination butonlarƒ± √ßalƒ±≈üƒ±yor
- [ ] Edit butonu custom field'lar i√ßin g√∂r√ºn√ºyor
- [ ] Delete butonu custom field'lar i√ßin g√∂r√ºn√ºyor
- [ ] View butonu system field'lar i√ßin g√∂r√ºn√ºyor
- [ ] Delete butonu system field'lar i√ßin disabled
- [ ] Create Field butonu y√∂nlendirme yapƒ±yor
- [ ] Loading state doƒüru √ßalƒ±≈üƒ±yor
- [ ] Empty state doƒüru √ßalƒ±≈üƒ±yor
- [ ] Error state doƒüru √ßalƒ±≈üƒ±yor

### Test Data
```typescript
// Backend'den d√∂necek √∂rnek field'lar
[
  { id: 'fld_created_at', name: 'created_at', label: 'Created At', type: 'datetime', category: 'System', is_system_field: true },
  { id: 'fld_email', name: 'email', label: 'Email Address', type: 'email', category: 'Contact Info', is_system_field: false },
  { id: 'fld_phone', name: 'phone', label: 'Phone Number', type: 'phone', category: 'Contact Info', is_system_field: false },
]
```

---

## Code Examples

### Complete Data Flow
```typescript
// 1. User visits /fields page
// 2. FieldsListPage component loads
// 3. useFields() hook fetches data from API
// 4. TanStack Query manages caching and loading state
// 5. FieldsTable receives fields array
// 6. TanStack Table renders table with sorting and pagination
// 7. User clicks filters ‚Üí state updates ‚Üí filtered data shown
// 8. User clicks Edit ‚Üí navigate to /fields/{id}/edit
```

### Error Handling
```typescript
// fields.api.ts
export const getFieldsAPI = async (params?: GetFieldsParams) => {
  try {
    const queryParams = new URLSearchParams();

    if (params?.category) {
      queryParams.append('category', params.category);
    }

    if (params?.is_system !== undefined) {
      queryParams.append('is_system', String(params.is_system));
    }

    const queryString = queryParams.toString();
    const url = `/api/fields${queryString ? `?${queryString}` : ''}`;

    const { data } = await apiClient.get<Field[]>(url);
    return data;
  } catch (error: any) {
    if (error.response?.status === 401) {
      throw new Error('Authentication required');
    }
    throw new Error('Failed to load fields. Please try again.');
  }
};
```

### Client-Side Filtering
```typescript
// FieldsListPage.tsx - Search and Type filter
const filteredFields = fields?.filter((field) => {
  // Search by name or label
  const matchesSearch =
    !search ||
    field.name.toLowerCase().includes(search.toLowerCase()) ||
    field.label.toLowerCase().includes(search.toLowerCase());

  // Filter by type
  const matchesType = !typeFilter || field.type === typeFilter;

  return matchesSearch && matchesType;
}) ?? [];
```

---

## Resources

### Backend Documentation
- [GET /api/fields](../../backend-docs/api/02-fields/02-list-fields.md) - Detailed endpoint documentation
- [Fields API Overview](../../backend-docs/api/02-fields/README.md) - Complete API reference
- [Frontend Developer Guide](../../backend-docs/api/00-FRONTEND-GUIDE.md) - Complete frontend guide

### Frontend Libraries
- [TanStack Table Docs](https://tanstack.com/table/latest)
- [TanStack Query Docs](https://tanstack.com/query/latest)
- [Lucide React Icons](https://lucide.dev/)

---

## ü§ñ Claude Code Prompt

**Task dosyasƒ±nƒ± Claude Code'a vermek i√ßin bu promptu kullan:**

```
Please implement the Field List Page task exactly as described in this file:
/Users/ali/Documents/Projects/canvas-app-frontend/tasks/03-fields-library/01-field-list-page.md

Requirements:
1. Create src/features/fields/pages/FieldsListPage.tsx - Main page with search, filters, and table
2. Create src/features/fields/components/FieldsTable.tsx - TanStack Table component with columns
3. Create src/features/fields/components/FieldsTableSkeleton.tsx - Loading skeleton
4. Create src/features/fields/components/FieldsTableEmpty.tsx - Empty state component
5. Create src/features/fields/components/FieldTypeIcon.tsx - Field type icon component
6. Create src/features/fields/hooks/useFields.ts - TanStack Query hook for fetching fields
7. Update src/lib/api/fields.api.ts - Add getFieldsAPI function
8. Create src/features/fields/types/field.types.ts - TypeScript type definitions

CRITICAL REQUIREMENTS:
- Use TanStack Table v8 for table implementation
- Table columns: name, label, type (with icon), category (badge), actions
- Implement search by name/label (client-side, debounced)
- Category filter (backend API query param)
- Type filter (client-side, 12 field types dropdown)
- System fields checkbox (backend API query param is_system)
- Pagination: 50 items per page (client-side)
- Actions: Edit button (custom fields), Delete button (custom fields), View button (system fields)
- System fields cannot be deleted (disable Delete button)
- Loading skeleton, empty state, and error state
- Mobile responsive design with Tailwind CSS 4

Backend API:
- GET /api/fields
- Query params: category (string), is_system (boolean)
- Returns array of Field objects

Follow the exact code examples and file structure provided in the task file.
```

---

**Status:** üü° Pending
**Next Task:** 02-create-field-form.md
